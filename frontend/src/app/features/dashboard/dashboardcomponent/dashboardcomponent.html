<div class="container-fluid py-4">
  <div class="mb-4">
    <h1 class="h2 animate__animated animate__lightSpeedInLeft">
      <i class="bi bi-speedometer2 text-dark me-2"></i>
      Dashboard
    </h1>
    <p class="text-muted animate__animated animate__lightSpeedInLeft">
      Welcome back, {{ currentUser?.username }}!
    </p>
  </div>

  @if (isStudent) {
  <!-- Student Dashboard -->
  <div class="alert alert-info">
    <i class="bi bi-info-circle me-2"></i>
    You are viewing as a <strong>Student</strong>. You can only access your own
    profile.
  </div>
  <div class="row g-4">
    <div class="col-md-6">
      <div class="card border-start border-4 border-success">
        <div class="card-body">
          <h5 class="card-title">
            <i class="bi bi-person-circle me-2"></i>
            My Profile
          </h5>
          <p class="card-text">View and manage your student information</p>
          <button [routerLink]="['/students', studentId]" class="btn btn-primary">
            <i class="bi bi-eye me-2"></i>
            View Profile
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card border-danger border-start border-4">
        <div class="card-body">
          <h5 class="card-title">
            <i class="bi bi-calendar-check me-2"></i>
            My Attendance
          </h5>
          <p class="card-text">Check your attendance records</p>
          <button class="btn btn-primary" [routerLink]="['/attendance/stats/', studentId]">
            <i class="bi bi-calendar me-2"></i>
            View Attendance
          </button>
        </div>
      </div>
    </div>
  </div>
  } @else if (isTeacher) {
  <!-- Teacher Dashboard -->
  <div class="alert alert-success">
    <i class="bi bi-info-circle me-2"></i>
    Welcome, <strong>Teacher</strong>! You can manage students and attendance.
  </div>
  <div class="row mt-4 mb-4">
    <div class="col-12 col-lg-6 mb-3 mb-lg-0">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-bar-chart-fill me-2"></i>
            User Distribution
          </h5>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas #barCanvas style="height: 400px"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-6">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-doughnut-chart-fill me-2"></i>
            Attendance Status
          </h5>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas #doughnutCanvas style="height: 400px"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row g-4">
    <div class="col-md-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">
            <i class="bi bi-people me-2"></i>
            Students
          </h5>
          <p class="card-text">View and edit student information</p>
          <button routerLink="/students" class="btn btn-primary">
            <i class="bi bi-arrow-right me-2"></i>
            Manage Students
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">
            <i class="bi bi-calendar-check me-2"></i>
            Attendance
          </h5>
          <p class="card-text">Mark and manage attendance</p>
          <button routerLink="/attendance" class="btn btn-primary">
            <i class="bi bi-arrow-right me-2"></i>
            Manage Attendance
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">
            <i class="bi bi-person-badge me-2"></i>
            My Profile
          </h5>
          <p class="card-text">View your teacher profile</p>
          <button [routerLink]="['/teachers', teacherId]" class="btn btn-primary">
            <i class="bi bi-arrow-right me-2"></i>
            View Profile
          </button>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-grid me-2"></i>
            Quick Actions
          </h5>
        </div>
        <div class="card-body">
          <div class="d-flex gap-2 flex-wrap">
            <button routerLink="/students/create" class="btn btn-primary">
              <i class="bi bi-plus-circle me-2"></i>
              Add Student
            </button>
            <button routerLink="/teachers/create" class="btn btn-success">
              <i class="bi bi-plus-circle me-2"></i>
              Add Teacher
            </button>
            <button routerLink="/subjects/create" class="btn btn-secondary">
              <i class="bi bi-plus-circle me-2"></i>
              Add Subjects
            </button>
            <button routerLink="/attendance/mark" class="btn btn-info">
              <i class="bi bi-calendar-plus me-2"></i>
              Mark Attendance
            </button>
            <button class="btn btn-warning" routerLink="/leave/review">
              <i class="bi bi-file-earmark-text me-2"></i>
              Review Leave Requests
            </button>
            <button [routerLink]="['/students/blacklist']" class="btn btn-danger">
              <i class="bi bi-file-earmark-text me-2"></i>
              View Blacklisted Students
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  } @else if (isParent) {
  <!-- Parent Dashboard -->
  <div class="alert alert-warning">
    <i class="bi bi-info-circle me-2"></i>
    Welcome, <strong>Parent</strong>! You can view your children's information.
  </div>
  <div class="row g-4">
    <div class="col-md-12">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">
            <i class="bi bi-people me-2"></i>
            My Children
          </h5>
          <p class="card-text">View your children's profiles</p>
          <button [routerLink]="['/parents', parentId]" class="btn btn-primary">
            <i class="bi bi-arrow-right me-2"></i>
            View Children
          </button>
        </div>
      </div>
    </div>
    <!-- <div class="col-md-6">
      <div class="card">
        <div class="card-body">
          <h5 class="card-title">
            <i class="bi bi-calendar-check me-2"></i>
            Attendance Records
          </h5>
          <p class="card-text">Check children's attendance</p>
          <button class="btn btn-primary" [routerLink]="['/attendance/stats/', studentId]">
            <i class="bi bi-calendar me-2"></i>
            View Attendance
          </button>
        </div>
      </div>
    </div> -->
  </div>
  } @else {
  <!-- Admin Dashboard -->
  <div class="alert alert-primary">
    <i class="bi bi-shield-check me-2"></i>
    Welcome, <strong>Administrator</strong>! You have full access to the system.
  </div>
  <div class="row g-4 animate__animated animate__zoomIn animate__delay-0.7s">
    <div class="col-md-3">
      <div class="card text-dark success border-success">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h6 class="card-title">Students</h6>
              <h2 class="mb-0">{{students.length}}</h2>
            </div>
            <i class="bi bi-people" style="font-size: 3rem; opacity: 0.3"></i>
          </div>
          <button routerLink="/students" class="btn success btn-sm mt-3 w-100 border-success">
            View All
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-dark warning border-warning">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h6 class="card-title">Teachers</h6>
              <h2 class="mb-0">{{teacher.length}}</h2>
            </div>
            <i class="bi bi-person-badge" style="font-size: 3rem; opacity: 0.3"></i>
          </div>
          <button routerLink="/teachers" class="btn btn-sm mt-3 w-100 warning border-warning">
            View All
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-dark primary border-primary">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h6 class="card-title">Parents</h6>
              <h2 class="mb-0">{{parents.length}}</h2>
            </div>
            <i class="bi bi-people-fill" style="font-size: 3rem; opacity: 0.3"></i>
          </div>
          <button class="btn primary btn-sm mt-3 w-100 border-primary" routerLink="/parents">
            View All
          </button>
        </div>
      </div>
    </div>
    <div class="col-md-3">
      <div class="card text-dark sec border-secondary">
        <div class="card-body">
          <div class="d-flex justify-content-between">
            <div>
              <h6 class="card-title">Attendance</h6>
              <h2 class="mb-0">{{attendance.length}}</h2>
            </div>
            <i class="bi bi-calendar-check" style="font-size: 3rem; opacity: 0.3"></i>
          </div>
          <button routerLink="/attendance" class="btn sec btn-sm mt-3 w-100 border-secondary">
            View Records
          </button>
        </div>
      </div>
    </div>
  </div>
  <!-- Weekly Attendance Trend Chart -->
  <div class="row mt-4">
    <div class="col-12">
      <div class="card chart-card">
        <div class="card-header chart-card-header">
          <div class="chart-header-top">
            <div class="chart-title-section">
              <h5 class="mb-0 chart-main-title">
                <i class="bi bi-graph-up me-2"></i>
                Weekly Attendance Overview
              </h5>
              <span class="chart-week-label">{{ weekRangeLabel }}</span>
            </div>
            <div class="chart-nav-controls">
              <button class="btn btn-sm chart-nav-btn" (click)="navigateWeek(-1)" title="Previous Week">
                <i class="bi bi-chevron-left"></i>
              </button>
              <button class="btn btn-sm chart-nav-btn today-btn" (click)="weekOffset = 0; updateLineChart()"
                [disabled]="weekOffset === 0">
                Today
              </button>
              <button class="btn btn-sm chart-nav-btn" (click)="navigateWeek(1)" [disabled]="weekOffset >= 0"
                title="Next Week">
                <i class="bi bi-chevron-right"></i>
              </button>
            </div>
          </div>
          <!-- Weekly summary stats -->
          <div class="chart-summary-row">
            <div class="chart-stat-badge present-badge">
              <span class="stat-dot present-dot"></span>
              <span class="stat-label">Present</span>
              <span class="stat-value">{{ weekSummary.present }}</span>
            </div>
            <div class="chart-stat-badge late-badge">
              <span class="stat-dot late-dot"></span>
              <span class="stat-label">Late</span>
              <span class="stat-value">{{ weekSummary.late }}</span>
            </div>
            <div class="chart-stat-badge leave-badge">
              <span class="stat-dot leave-dot"></span>
              <span class="stat-label">On Leave</span>
              <span class="stat-value">{{ weekSummary.onLeave }}</span>
            </div>
            <div class="chart-stat-badge absent-badge">
              <span class="stat-dot absent-dot"></span>
              <span class="stat-label">Absent</span>
              <span class="stat-value">{{ weekSummary.absent }}</span>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="chart-container chart-wide">
            <canvas #lineCanvas style="height: 400px"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-4">
    <div class="col-12 col-lg-6 mb-3 mb-lg-0">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-bar-chart-fill me-2"></i>
            User Distribution
          </h5>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas #barCanvas style="height: 400px"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-12 col-lg-6">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-doughnut-chart-fill me-2"></i>
            Attendance Status
          </h5>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas #doughnutCanvas style="height: 400px"></canvas>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row mt-4">
    <div class="col-12">
      <div class="card">
        <div class="card-header">
          <h5 class="mb-0">
            <i class="bi bi-grid me-2"></i>
            Quick Actions
          </h5>
        </div>
        <div class="card-body">
          <div class="d-flex gap-2 flex-wrap">
            <button routerLink="/students/create" class="btn btn-primary">
              <i class="bi bi-plus-circle me-2"></i>
              Add Student
            </button>
            <button routerLink="/teachers/create" class="btn btn-success">
              <i class="bi bi-plus-circle me-2"></i>
              Add Teacher
            </button>
            <button routerLink="/subjects/create" class="btn btn-secondary">
              <i class="bi bi-plus-circle me-2"></i>
              Add Subjects
            </button>
            <button routerLink="/attendance/mark" class="btn btn-info">
              <i class="bi bi-calendar-plus me-2"></i>
              Mark Attendance
            </button>
            <button class="btn btn-warning" routerLink="/leave/review">
              <i class="bi bi-file-earmark-text me-2"></i>
              Review Leave Requests
            </button>
            <button [routerLink]="['/students/blacklist']" class="btn btn-danger">
              <i class="bi bi-file-earmark-text me-2"></i>
              View Blacklisted Students
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
  }
</div>