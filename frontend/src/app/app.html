@if (authService.isAuthenticated()) {
<div class="wrapper">
  <!-- Sidebar -->
  <aside class="sidebar" [class.collapsed]="sidebarCollapsed">
    <div class="sidebar-header">
      <div class="logo">
        <img src="https://cdn-icons-png.flaticon.com/512/3589/3589030.png" alt="" class="user-avatar-img rounded-0" />
        <span class="logo-text">Attendance</span>
      </div>
      <button class="sidebar-toggle" (click)="toggleSidebar()">
        <i class="bi" [class.bi-chevron-left]="!sidebarCollapsed" [class.bi-chevron-right]="sidebarCollapsed"></i>
      </button>
    </div>

    <nav class="sidebar-nav">
      <ul class="nav-list">
        <li class="nav-item">
          <a class="nav-link" routerLink="/dashboard" routerLinkActive="active">
            <i class="bi bi-speedometer2"></i>
            <span class="nav-text">Dashboard</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/students" routerLinkActive="active">
            <i class="bi bi-people"></i>
            <span class="nav-text">Students</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/teachers" routerLinkActive="active">
            <i class="bi bi-person-badge"></i>
            <span class="nav-text">Teachers</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/attendance" routerLinkActive="active">
            <i class="bi bi-calendar-check"></i>
            <span class="nav-text">Attendance</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/leave/request" routerLinkActive="active">
            <i class="bi bi-calendar-x"></i>
            <span class="nav-text">Leave Request</span>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/subjects" routerLinkActive="active">
            <i class="bi bi-book"></i>
            <span class="nav-text">Subjects</span>
          </a>
        </li>
      </ul>
    </nav>

    <div class="sidebar-footer">
      <div class="user-info">
        <div class="user-avatar">
          @if(currentUser?.role === 'Student') {
          <img src="{{studentData?.photo}}" alt="User" class="user-avatar-img" />
          }@else {
          <i class="bi bi-person-circle"></i>
          }
        </div>
        <div class="user-details">
          <span class="username">{{ currentUser?.username.toUpperCase() }}</span>
          <span class="user-role">{{currentUser?.role}}</span>
        </div>
      </div>
    </div>
  </aside>

  <!-- Main Content Area -->
  <div class="main-content">
    <!-- Top Navbar -->
    <header class="top-navbar">
      <div class="navbar-left">
        <button class="mobile-toggle" (click)="toggleSidebar()">
          <i class="bi bi-list"></i>
        </button>
        <h1 class="page-title">School Management System</h1>
      </div>

      <div class="navbar-right">
        <button class="nav-icon-btn" title="Notifications">
          <i class="bi bi-bell"></i>
          <span class="badge">3</span>
        </button>

        <button class="nav-icon-btn" title="Messages">
          <i class="bi bi-envelope"></i>
        </button>

        <div class="user-menu">
          <button class="user-menu-btn" (click)="toggleUserMenu()">
            @if(currentUser.role === "Student"){
            <img src="{{studentData?.photo}}" alt="User" class="user-avatar-img" />
            }@else {
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTUlOnqog4d0763K2WzYq1ugV5OFhgq69ilnw&s"
              alt="User" class="user-avatar-img" />
            }
            <span class="user-name">{{ currentUser?.username }}</span>
            <i class="bi bi-chevron-down"></i>
          </button>

          @if (userMenuOpen) {
          <div class="user-dropdown">
            <a class="dropdown-item" href="#">
              <i class="bi bi-gear"></i>
              <span>Settings</span>
            </a>
            <hr class="dropdown-divider" />
            <a class="dropdown-item text-danger" (click)="logout()">
              <i class="bi bi-box-arrow-right"></i>
              <span>Logout</span>
            </a>
          </div>
          }
        </div>
      </div>
    </header>

    <!-- Page Content -->
    <main class="page-content">
      <router-outlet />
    </main>
  </div>
</div>
} @else {
<router-outlet />
}